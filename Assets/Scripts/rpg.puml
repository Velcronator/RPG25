@startuml RPG
namespace RPG.Combat {
    class Fighter {
        -float weaponRange
        -float timeBetweenAttacks
        -float weaponDamage
        -Health target
        -float timeSinceLastAttack
        +void Update()
        +void Attack(GameObject combatTarget)
        +void Cancel()
        +bool CanAttack(GameObject combatTarget)
        -void AttackBehaviour()
        -void TriggerAttack()
        -void StopAttack()
        -void Hit() // Animation Event
        -bool GetIsInRange()
    }

    class CombatTarget {
    }

    Fighter --> CombatTarget : interacts
}

namespace RPG.Control {
    class PlayerController {
        -Health health
        +void Start()
        +void Update()
        -bool InteractWithCombat()
        -bool InteractWithMovement()
        -static Ray GetMouseRay()
    }

    class AIController {
        -float chaseDistance
        -float suspicionTime
        -PatrolPath patrolPath
        -float waypointTolerance
        -float waypointDwellTime
        -Fighter fighter
        -Health health
        -Mover mover
        -GameObject player
        -Vector3 guardPosition
        -float timeSinceLastSawPlayer
        -float timeSinceArrivedAtWaypoint
        -int currentWaypointIndex
        +void Start()
        +void Update()
        -void UpdateTimers()
        -void PatrolBehaviour()
        -bool AtWaypoint()
        -void CycleWaypoint()
        -Vector3 GetCurrentWaypoint()
        -void SuspicionBehaviour()
        -void AttackBehaviour()
        -bool InAttackRangeOfPlayer()
    }

    PlayerController --> Fighter : uses
    PlayerController --> Mover : uses
    PlayerController --> CombatTarget : interacts
    AIController --> Fighter : uses
    AIController --> Mover : uses
    AIController --> PatrolPath : uses
}

namespace RPG.Core {
    interface IAction {
        +void Cancel()
    }
    class ActionScheduler {
        -IAction currentAction
        +void StartAction(IAction action)
        +void CancelCurrentAction()
    }
    class FollowCamera {
        -Transform target
        +void LateUpdate()
    }
    class Health {
        -float healthPoints
        -bool isDead
        +bool IsDead()
        +void TakeDamage(float damage)
        -void Die()
    }
    Fighter --> Health : targets
    CombatTarget --> Health : requires
    PlayerController --> Health : uses
    AIController --> Health : uses
    Mover --> Health : uses
    Fighter ..|> IAction
    Fighter --> ActionScheduler : uses
}

namespace RPG.Movement {
    class Mover {
        -Transform target
        -NavMeshAgent navMeshAgent
        -Health health
        +void Start()
        +void Update()
        +void StartMoveAction(Vector3 destination)
        +void MoveTo(Vector3 destination)
        +void Cancel()
        -void UpdateAnimator()
    }
    Fighter --> Mover : uses
    PlayerController --> Mover : uses
    AIController --> Mover : uses
}

namespace RPG.Cinematics {
    class CinematicControlRemover {
        -GameObject player
        +void Start()
        -void DisableControl(PlayableDirector pd)
        -void EnableControl(PlayableDirector pd)
    }

    class CinematicTrigger {
        -bool alreadyTriggered
        +void OnTriggerEnter(Collider other)
    }

    CinematicControlRemover --> PlayerController : disables
    CinematicControlRemover --> ActionScheduler : uses
    CinematicTrigger --> PlayableDirector : uses
}
@enduml
